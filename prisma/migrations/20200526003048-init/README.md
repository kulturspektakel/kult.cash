# Migration `20200526003048-init`

This migration has been generated by Daniel BÃ¼chele at 5/26/2020, 12:30:48 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."Device" (
"id" TEXT NOT NULL  ,"lastSeen" DATE   ,"latestVersion" INTEGER   ,"listName" TEXT   ,
    PRIMARY KEY ("id"),FOREIGN KEY ("listName") REFERENCES "List"("name") ON DELETE SET NULL ON UPDATE CASCADE)

CREATE TABLE "quaint"."List" (
"emoji" TEXT   ,"name" TEXT NOT NULL  ,"price1" INTEGER   ,"price2" INTEGER   ,"price3" INTEGER   ,"price4" INTEGER   ,"price5" INTEGER   ,"price6" INTEGER   ,"price7" INTEGER   ,"price8" INTEGER   ,"price9" INTEGER   ,"product1" TEXT   ,"product2" TEXT   ,"product3" TEXT   ,"product4" TEXT   ,"product5" TEXT   ,"product6" TEXT   ,"product7" TEXT   ,"product8" TEXT   ,"product9" TEXT   ,
    PRIMARY KEY ("name"))

CREATE TABLE "quaint"."Transaction" (
"balanceAfter" INTEGER NOT NULL  ,"balanceBefore" INTEGER NOT NULL  ,"card" TEXT NOT NULL  ,"createdAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"deviceId" TEXT NOT NULL  ,"deviceTime" DATE NOT NULL  ,"id" TEXT NOT NULL  ,"listName" TEXT NOT NULL  ,"mode" INTEGER NOT NULL  ,"tokensAfter" INTEGER NOT NULL  ,"tokensBefore" INTEGER NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("deviceId") REFERENCES "Device"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."CartItem" (
"amount" INTEGER NOT NULL  ,"price" INTEGER NOT NULL  ,"product" TEXT NOT NULL  ,"transactionId" TEXT NOT NULL  ,
    PRIMARY KEY ("transactionId","product"),FOREIGN KEY ("transactionId") REFERENCES "Transaction"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."Session" (
"expires" DATE NOT NULL  ,"token" TEXT NOT NULL  ,"userId" TEXT NOT NULL  ,
    PRIMARY KEY ("token"))

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200526003048-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,73 @@
+datasource sqlite {
+  provider = "sqlite"
+  url      = "file:./contactless.db"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model Device {
+  id            String        @id
+  lastSeen      DateTime?
+  latestVersion Int?
+  transactions  Transaction[]
+  list          List?         @relation(fields: [listName], references: [name])
+  listName      String?
+}
+
+model List {
+  name     String   @id
+  emoji    String?
+  product1 String?
+  price1   Int?
+  product2 String?
+  price2   Int?
+  product3 String?
+  price3   Int?
+  product4 String?
+  price4   Int?
+  product5 String?
+  price5   Int?
+  product6 String?
+  price6   Int?
+  product7 String?
+  price7   Int?
+  product8 String?
+  price8   Int?
+  product9 String?
+  price9   Int?
+  devices  Device[]
+}
+
+model Transaction {
+  id            String     @id
+  device        Device     @relation(fields: [deviceId], references: [id])
+  deviceId      String
+  mode          Int
+  deviceTime    DateTime
+  card          String
+  balanceBefore Int
+  tokensBefore  Int
+  balanceAfter  Int
+  tokensAfter   Int
+  listName      String
+  cartItems     CartItem[]
+  createdAt     DateTime   @default(now())
+}
+
+model CartItem {
+  transaction   Transaction @relation(fields: [transactionId], references: [id])
+  transactionId String
+  product       String
+  price         Int
+  amount        Int
+
+  @@id([transactionId, product])
+}
+
+model Session {
+  token   String   @id
+  userId  String
+  expires DateTime
+}
```


